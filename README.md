# Ollama 网页翻译 Chrome 插件

一个使用本地 Ollama 服务或云端 OpenRouter API 翻译网页内容的 Chrome 浏览器扩展插件。

## 功能特性

- 🌐 **多种翻译模式**：支持选中文字翻译、整个页面翻译、悬停翻译
- 🎯 **多供应商支持**：支持本地 Ollama 服务和云端 OpenRouter API
- 🔒 **隐私保护**：本地服务完全离线，云端服务按需付费
- 🌍 **多语言支持**：支持中文、英语、日语、韩语、法语、德语、西班牙语等多种语言
- 🎨 **美观界面**：现代化的用户界面设计
- ⚡ **右键菜单**：方便快捷的右键菜单操作
- 💾 **设置保存**：自动保存用户配置
- 🚀 **高性能模型**：支持 Claude、GPT、Llama 等多种大语言模型

## 安装步骤

### 1. 选择翻译供应商

插件支持两种翻译供应商：

#### 选项 A：本地 Ollama 服务（推荐）

首先确保本地已安装并运行 Ollama 服务：

```bash
# 安装 Ollama（如果尚未安装）
# 访问 https://ollama.com 下载并安装

# 启动 Ollama 服务
ollama serve

# 拉取翻译模型（推荐使用 qwen2:7b 或其他支持中文的模型）
ollama pull qwen2:7b
```

#### 选项 B：云端 OpenRouter API

1. 访问 [OpenRouter 官网](https://openrouter.ai/keys) 注册账号
2. 创建 API Key
3. 在插件设置中配置 API Key 和模型

**OpenRouter 优势**：
- 无需本地部署，开箱即用
- 支持多种高性能模型（Claude、GPT、Llama 等）
- 按使用量付费，灵活控制成本
- 无需担心本地硬件配置

### 2. 生成图标文件

项目提供了一个图标生成器，可以快速生成所需图标：

1. 在浏览器中打开项目根目录下的 [`generate-icons.html`](generate-icons.html:1) 文件
2. 点击"下载所有图标"按钮，或分别下载每个图标
3. 将下载的三个图标文件保存到 `icons` 文件夹中：
   - `icon16.png` (16x16 像素)
   - `icon48.png` (48x48 像素)
   - `icon128.png` (128x128 像素)

图标采用渐变紫色设计，包含翻译符号，与插件主题完美匹配。

### 3. 安装 Chrome 插件

1. 打开 Chrome 浏览器
2. 在地址栏输入 `chrome://extensions/`
3. 开启右上角的 **"开发者模式"** 开关
4. 点击左上角的 **"加载已解压的扩展程序"** 按钮
5. 在文件选择器中，选择本项目的 `translate` 文件夹
6. 点击"选择文件夹"
7. 插件安装完成！

### 4. 使用方法

#### 方法 1：通过插件界面

1. 点击浏览器工具栏中的插件图标
2. 确认配置正确（Ollama 或 OpenRouter）
3. 选择翻译模式：
   - **选中文字**：翻译您在网页上选中的文本
   - **整个页面**：翻译当前网页的所有文本内容
   - **悬停翻译**：鼠标悬停在文本上时显示翻译
4. 点击"翻译"按钮

### 通过右键菜单

1. 在网页上选中要翻译的文字
2. 右键点击选择"翻译选中文字"
3. 翻译结果会以弹窗形式显示

或者：

1. 在网页上右键点击
2. 选择"翻译整个页面"
3. 页面所有文本将被翻译

### 恢复原文

如果翻译了整个页面，可以通过右键菜单选择"恢复原文"来恢复原始内容。

## 配置说明

### API 供应商选择

插件支持两种翻译供应商，各有优劣：

| 特性 | Ollama (本地) | OpenRouter (云端) |
|------|----------------|------------------|
| 部署方式 | 需要本地安装 | 无需部署，开箱即用 |
| 隐私性 | 完全离线，数据不出本地 | 需要网络连接 |
| 成本 | 免费（需硬件投入） | 按使用量付费 |
| 模型选择 | 本地已安装的模型 | 多种云端模型可选 |
| 性能 | 取决于本地硬件 | 云端高性能 |
| 稳定性 | 依赖本地服务 | 云端服务稳定 |

### Ollama 配置

**服务地址**：默认地址为 `http://localhost:11434`，如果您的 Ollama 服务运行在其他地址或端口，请相应修改。

**模型名称**：推荐使用支持中文的模型，例如：
- `qwen2:7b` - 推荐使用
- `qwen2:1.5b` - 速度更快
- `llama3:8b` - 通用模型
- `gemma:7b` - Google 模型

您可以通过以下命令查看已安装的模型：

```bash
ollama list
```

### OpenRouter 配置

**API Key**：从 [OpenRouter 官网](https://openrouter.ai/keys) 获取 API Key。

**模型选择**：支持多种模型，例如：
- `anthropic/claude-3-haiku` - 快速且经济
- `anthropic/claude-3-sonnet` - 平衡性能
- `openai/gpt-4o-mini` - OpenAI 模型
- `meta-llama/llama-3.1-8b` - Meta 模型

**可选配置**：
- **站点 URL**：用于识别您的应用（可选）
- **应用名称**：显示在 OpenRouter 控制台（可选）

### 目标语言

支持的语言包括：
- 中文
- English (英语)
- 日本語 (日语)
- 한국어 (韩语)
- Français (法语)
- Deutsch (德语)
- Español (西班牙语)

## 项目结构

```
translate/
├── manifest.json       # 插件配置文件
├── popup.html          # 弹窗界面 HTML
├── popup.css           # 弹窗样式
├── popup.js            # 弹窗交互逻辑
├── content.js          # 内容脚本（处理网页内容）
├── background.js       # 后台服务脚本
├── generate-icons.html # 图标生成器工具
├── icons/              # 图标文件夹
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
├── README.md           # 项目说明文档
├── INSTALL.md          # 详细安装指南
└── QUICKSTART.md       # 快速开始指南
```

## 技术栈

- **Chrome Extension API**：Manifest V3
- **Vanilla JavaScript**：纯原生 JavaScript，无依赖
- **CSS3**：现代化样式设计
- **Ollama API**：本地大语言模型服务

## 注意事项

1. **Ollama 服务必须运行**：确保 Ollama 服务正在运行，否则翻译功能无法使用
2. **模型要求**：确保已下载并安装支持目标语言的模型
3. **性能考虑**：翻译整个页面可能需要较长时间，取决于页面内容和模型性能
4. **网络限制**：由于使用本地服务，不需要网络连接，但需要确保 localhost 访问正常

## 故障排除

### 翻译失败

- 检查 Ollama 服务是否正在运行
- 确认服务地址和端口配置正确
- 验证模型名称是否正确
- 查看浏览器控制台是否有错误信息

### 无法连接 Ollama

- 确认 Ollama 服务已启动：`ollama serve`
- 检查防火墙设置是否阻止了 localhost 连接
- 尝试在浏览器中访问 `http://localhost:11434/api/tags` 测试连接

### 翻译速度慢

- 使用更小的模型（如 `qwen2:1.5b`）
- 减少翻译的文本量
- 检查系统资源使用情况

## 开发计划

- [ ] 添加翻译历史记录
- [ ] 支持自定义翻译提示词
- [ ] 添加批量翻译功能
- [ ] 支持更多语言
- [ ] 添加快捷键支持
- [ ] 优化翻译性能

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！

## 联系方式

如有问题或建议，请通过 GitHub Issues 联系。
